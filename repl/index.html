<html>
  <head>
    <script>
     var z = undefined;
     function webSocketTest() {
       var ws = new WebSocket("ws://localhost:8000");

       ws.onopen = () => {
         ws.send("initial from js");
       };

       ws.onmessage = evt => {
         var m = evt.data;
         z = new Function("return " + m)();
         console.log( m );
       };

       ws.onclose = function() {
         alert("ws closed");
       };

       window.onbeforeunload = evt => {
         socket.close();
       };
     }
     webSocketTest();
    </script>
  </head>
  <body>
    hello there
  </body>
</html>
